# Page no 722

x <- c(82 ,85 ,83 ,64 ,82 ,53 ,26 ,47 ,37 ,49 ,65 ,40 ,32 ,50 ,62 ,33 ,
       36 ,53 ,50 ,71 ,54 ,62, 47, 66, 34, 46, 27, 54, 72, 41, 35, 75, 
       50, 76, 28)
y <- c(169.62 ,48.94 ,41.16 ,63.95 ,21.09 ,5.40 ,6.33 ,4.26 ,3.62 ,4.82 
       ,108.22, 10.20, 2.69, 6.16, 23.87, 2.70, 3.15, 60.59, 4.48, 46.93,
       30.91, 34.27, 41.44, 109.88, 2.78, 4.17, 6.57, 61.73, 47.59, 10.46
       , 3.06, 49.57, 5.55, 50.23, 6.81)

n <- length(x)
rank_x <- rank(x)
rank_y <- rank(y)
d <- rank_x - rank_y
d_sq <- d^2
data <- data.frame(x, y, rank_x, rank_y, d, d_sq)
data

r_s <- 1 - ( (6*sum(d_sq))/(n*(n^2-1)) )
r_s
z <- r_s * sqrt(n-1)
cor.test(x, y, method = "spearman")